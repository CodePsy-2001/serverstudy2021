# day6 (프론트엔드, 세션)

지표 시스템을 만들기 위해선, 내가 완성한 토이프로젝트보다 훨씬 더 많은 것을 알아야 한다. 프론트엔드 기본도 숙지하고 있어야 하고, 세션 등의 개념에도 익숙해져야 한다. 프론트엔드를 짤 줄은 몰라도, 최소한 코드를 읽느라 어지럽지는 말야아 한다. 

사용자에게 화면이 어떻게 보일지부터 먼저 신경쓰는 건 애자일 방법론과도 일맥상통한다. 사용자가 자발적으로 자신의 정보를 내어주도록 유도해야 하기 때문에, 회사 프로젝트에 한해서만큼은 백엔드보다도 프론트엔드가 더 중요하다고 할 수도 있겠다.





### 프론트엔드 (flask - HTML)

- flask에서 Form 입력창을 객체화해 좀 더 쉽게 다룰 수 있다. validator, basic-field 등... 폼 검증과 관련된 다양한 속성을 지원한다. 단, 클라이언트 HTML 단에서 사용자의 입력을 받는 데에만 사용된다.

  + 나중에 session, login 등을 관리할 때 DB 객체화를 위해 요긴하게 사용할 수 있다. flask_wtf 는 CSRF 토큰을 사용해 사용자의 요청이 실제 웹페이지에서 보낸 요청인지를 검증한다.
  + flask 함수를 그대로 HTML 태그 안에 넣어도 괜찮지만,  value 속성에 data 값만 따서 넣어주는 게 더 낫다. CSS 클래스 등 다양한 속성을 지정할 수 있기 때문이다.
  + js에서 바로 FormData를 전송하기 위해선 여전히 XML 기법을 알아야 한다.

- 바 메뉴, 햄버거 메뉴, 페이징 등 다양한 프론트엔드를 숙지하고 있어야 백엔드 개발도 원활하게 할 수 있다. 예를 들면 페이징 기능은 프론트엔드에 가깝지만 views 쪽에서 templates에 전달해주는 값을 바꾸는 식으로 작동한다. flask가 일해야 하는 것이다.
- flask HTML for 문에 익숙해지는 게 중요하고, bootstrap 등 유명 CSS 파일 클래스에 적응하는 게 필요하다. 바로 백엔드 개발에 뛰어들 생각이었지만, 나중에 나 혼자 서비스를 만들어 배포할 생각이라면 프론트엔드도 완벽히 숙지하는 게 좋겠다. '풀 스택'이란 말이 괜히 나온 게 아니다.
- 템플릿 필터 (예: datetime 문자열을 '3일 전' 등으로 표시해주는 등) 기능도 따로 filters.py 로 빼서 구현하는 게 좋다.
  + [Template Designer Documentation — Jinja Documentation (3.0.x) (palletsprojects.com)](https://jinja.palletsprojects.com/en/2.11.x/templates/#builtin-filters) flask - HTML 빌트인 필터 목록

- 특정 변수에 따라 다른 템플릿이 표시되도록 할 수 있다.





### Session

- 세션이란? 쉽게 말해 서버가 가지고 있는 임시 저장값(쿠키와 비슷)이다. login을 거쳐야만 세션(=DB에서 따온 사용자 고유키)이 형성되도록 만들면, 세션의 유무로 사용자가 로그인 상태인지 아닌지 쉽게 판별할 수 있다.

- g 객체는 flask 안의 모든 영역에서 공유되는 범용 객체이다. 여기서 각종 변수(사용자 세션값 등)를 다루면 자동 공유되므로 편리하게 이용할 수 있다.
  + @Blueprint.before_app_request 어노테이션을 활용하자. 함수 앞에 붙이면 그 함수는 route된 함수들이 request를 받기 전마다 앞서 실행된다. g.user 에 세션으로부터 추출된 user DB의 인스턴스를 저장하면 된다.
  + 해당 어노테이션을 사용하는 함수를 통째로 다시 어노테이션으로 만들어버리면 더 좋다. 어노테이션 기능만 잘 다뤄도 코딩에 걸리는 시간이 압도적으로 단축된다.

- __중요!__ 세션값을 그냥 받으면 안 되고, 사용자의 쿠키에 암호화 후 전달해서 서버 내 세션 ID와 일치하는지 봐야 한다. 다른 방법의 구현도 얼마든지 존재할 수 있지만, 어쨌든 사용자 로그인 보안을 명확히 지켜나가면서 서버를 구축해나가는 것이 모든 서비스 개발의 기초다. 안 그러면 DB가 털린다. DB가 털리면 팔 수가 없다!
  + 관습적으로 다른 DB 및 서버 시스템이 어떻게 구성되는지 눈여겨보는 게 중요하다. 이번 인턴 경험이 나에게 정말 큰 도움이 되어주는 이유도 바로 실전 경험에 바로 참여해볼 수 있기 때문이다.
  + 세션을 바로 짤 필요는 없지만, 코드만 보고도 어떤 구조인지 명확히 이해할 정도는 되어야 한다.






### 기타

- DB에서 filter_by() 로 뽑은 값이 존재하는지 확인하고 싶을 땐, 뒤에 .first() 를 붙이면 된다.
  + if ( User.query.filter_by(username=form.username.data).first() ):
- username 등 unique한 값이 있든 말든, ID는 무조건 따로 생성하는 게 좋다. ID 값이 프론트엔드에 노출되지 않도록 하기 위함이다.
- 프로젝트가 커지니까 두뇌가 프로젝트의 복잡도를 감당하질 못한다! 무슨 엄청나게 복잡한 서버도 아니고, 그냥 로그인 기능이 구현된 웹게임 서버일 뿐인데... 기획서 등등 문서를 잘 활용하는 게 좋겠다.
- 선배님과 마지막에 회의를 나눈 게 도움이 많이 되었다.





