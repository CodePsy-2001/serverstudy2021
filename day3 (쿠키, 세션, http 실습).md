# day3 (쿠키, http 실습)

공부하면서 크게 느낀점이 있었거나 특이한 오류가 발생했던 점만 적는다.

실습 : snake-game 뜯어고치기



아래 개선사항은 목차를 완벽하게 따르지 않는다. 대신 시간 순서대로다.

### GET과 POST 통신 받도록 개선 

- url_for 함수에 'static' 같은 특정 이름만 지정할 수 있는 것__처럼 보이는__ 것은, url_for 함수는 endpoint 이후 args** 를 전달받아 string 형태로 뽑아주는 함수이기 때문이다.

- p5.js 에서 소리를 재생할 때마다 soundbuffer list length 관련 오류가 계속 나온다. 깃허브 이슈로도 몇 번 올라왔는데, 아직까지 고쳐지지 않았다. 오작동하는 건 아니니 그냥 무시하면 된다.
- 자바스크립트의 get은 굉장히 유용하다. 뱀 몸통 전체를 head와 tail로 임의로 분리할 수도 있고, 그렇게 만든 get을 다른 get에 사용할 수도 있다. 점수를 뱀의 꼬리부분의 길이로 나타냈다. innerHTML 업데이트는 loop 안 game.show() 에서 작동시켜주면 된다.
  + get score() {
    	return this.tails.length;
    }
  + HTTP보다 객체지향 프로그래밍이 훨씬 재밌는 것 같다.

- 필요에 따라 GET과 POST를 사용할 수 있고, 중앙에서 view를 통제할 수 있다.



### 쿠키로 사용자 개인 최고기록을 저장하도록 개선

- getCookie(), setCookie() 함수를 선언해, 뱀의 highscore를 쿠키로 저장하도록 만들었다.
- 쿠키를 삭제하려면 만료기간을 음수로 설정하면 된다. delCookie() 함수를 실행하는 버튼을 만들었다.
  + 쿠키 관련한 실행만 따로 처리하는 객체? 파일? 모듈?이 필요할 것 같다. 아직은 크기가 그렇게 크지 않으니 game.js에 합쳐서 처리하고 있지만.
- 쿠키에 저장한 값을 따로 form으로 다시 감싸서 POST 형식으로 전송한다. getElementsByName() 관련해서 시간을 많이 허비했다. 반환형이 리스트이기 때문에 반드시 인덱싱을 해줘야 한다. Javascript가 타입 검사를 워낙 느슨하게 해서 이런 문제가 생긴 것 같다. 어쨌든 한번 고생해봤으니 다시는 안 하겠지....
  + React 로 프론트를 만들기 시작하면 이런 HTML-자바스크립트 연동 함수는 신경쓰지 않게 된다고 한다. 어서 백엔드 공부를 마치고 프론트엔드에도 적응해보고 싶다.
- POST로 username과 highscore 정보를 받으면 그것을 DB에 저장한다. 이미 존재하는 사용자 이름이면서 동시에 종전 최고기록보다 높은 값이 전송되면, 종전 최고기록을 덮어씌운다.



### DB 연동 페이지 추가

- 원리는 이해하고 있다. flask 로 질의응답 만들기를 해본 적도 있었으니까 (물론 수박 겉핥기였지만).
- 하지만 토이프로젝트를 만들면서 갈증이 점점 심해졌다. Javascript, Python, HTML별로 이름을 일일이 지정해주다 시간이 다 가버릴 것 같았다. 이 변수가 저 변수였나 헷갈리기도 하고, 구글링 조금만 해봐도 '값을 한번에 json으로 쉽게 보낼 수 있답니다' 라는 글이 나오는데, 정작 그 방법과 기초적인 원리를 하나도 모르겠고....
- 그러던 중, 선배님께서 XML과 axios, 비동기 프로그램에 대한 조언을 해주셨다. 원래 기본 http, html 공부를 한 다음 갈증을 느끼면서 XML 공부를 하는 것이 정석인 모양이다. 내일부터는 XML을 활용해, DB 연동 페이지를 추가해봐야겠다. (물론 DB는 pybo로 만지는 거지만, 데이터는 POST로 받기 때문에...)

